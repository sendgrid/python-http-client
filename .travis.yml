language: python
sudo: false
cache: pip
python:
- '2.7'
- '3.4'
- '3.5'
- '3.6'
# Enable 3.7 without globally enabling sudo and dist: xenial for other build jobs
matrix:
  include:
  - python: 3.7
    dist: xenial
    sudo: true
fail_fast: true
before_install:
- pip install pycodestyle
- if [[ "$TRAVIS_PYTHON_VERSION" == 2.7* ]]; then pip install mock; fi
install:
- pip install virtualenv --upgrade
- make install
- make test-install
script:
- pycodestyle
- coverage run -m unittest discover
after_script:
- codecov
- make test
- coverage run tests/test_unit.py
after_success:
- codecov
deploy:
  provider: pypi
  user: thinkingserious
  password:
    secure: LICjgQDHDZUYFbhrxd/4KGlamfMPMu7Oqf7DCskfJwQqvZTrC7VyvOsPqVtCIIpw/GyE606KagkTEV7nTvwxCWGDQpQ0gkLkUkDzxziJlwKJEjYA3rGzxHCqdGRF6mQLThIpaUwaIpM7Ue4LUyhMSNw7b84F/dg1gWzK+LuqzY6UIRUmu6O2XvwoCWnbmrDrqExgOB7oyBABqlhmISr5x8JeMH+HRSTaHQW0QWeckEYUBPlSdXa4lj1pMfaRIlU3r7vB0Tckh5wtgu/B0t5I7enrdYHxaqIVCsh65c/8pDxXpI7anRCrPFU3SEGbodfe6rtNY4WlhWKaTJIPpQbKFU/NyYIjbox6rhdJ/bbC7hMfAxqTWzp1urJQxdWd5cbDUwNWgukdP5KhWA+iqy35llfb2KlFG6AVKHy4iR93is8hGW2NwCsSlx18W82AqpARJA22TWEIbKbyy6+GoiiIEmXxWleqriTqLuTLpPjyAby4pcW5gqtjVzEJ7Gi+Eq+Ex0pMUdOpXIt3kIk8TAB2chlGWr7+j9GuDN89LY0brSM+Q0fP8X3gohVQI5Afl8A+5ygQW5l//y2dakZ0KLSj6JjSyWMWMahrPHpxdUeNKjfENscU00AJSrskoAJvU1N4oyLIABrA7oMG5ZJXpASsixBimypayCCPJe50p+tEWW4=
  on:
    branch: master
    condition: "$TRAVIS_TEST_RESULT = 0"
    tags: true
